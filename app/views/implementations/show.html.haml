- content_for(:header) do
  %h1
    = link_to(@implementation.function.name, @implementation.function)
    %small
      Implemented by
      = link_to(@implementation.user.name, @implementation.user)

  %p
    = pluralize(@implementation.upvotes.count, 'upvote')
    - if logged_in?
      - if current_user.upvoted?(@implementation)
        = disabled_link('Upvoted', :class => 'upvote')
      - else
        = link_to('Upvote', upvote_implementation_path(@implementation), :class => 'upvote')

= readonly_code_mirror(:source, @implementation.source)

%h2= pluralize(@implementation.comments_count, 'Comment')

- @implementation.comments.each do |comment|
  .comment
    %h3
      = gravatar_image_tag(comment.user.email, :gravatar => { :size => 50 })
      = link_to(comment.user.name, comment.user)
      %small= "#{time_ago_in_words(comment.created_at)} ago"
    %p= comment.content

= form_tag(comment_on_implementation_path(@implementation)) do
  %fieldset
    %legend Leave a comment
    .field= text_area_tag(:content)
    .field= submit_tag('Comment')
